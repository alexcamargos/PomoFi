<div class="timer-card">
  <!-- Header -->
  <div class="card-header" cdkDragHandle>
    <div class="title">
      <span class="material-symbols-rounded">timer</span>
      <span>PomoFi Timer</span>
    </div>
    <div class="window-controls">
      <button class="control-btn small">
        <span class="material-symbols-rounded">more_horiz</span>
      </button>
    </div>
  </div>

  <!-- Timer Display -->
  <div class="timer-display-section">
    <div class="status-label">FOCUS</div>

    <div class="time-value">
      <span #inputMinutes [contentEditable]="contentEditable" (blur)="saveValues()"
        (keydown)="validateInput($event, 'minutes')" (focus)="handleFocus($event)" [class.editable]="contentEditable">{{
        minutes | number: '2.0' }}</span>
      <span class="colon">:</span>
      <span #inputSeconds [contentEditable]="contentEditable" (blur)="saveValues()"
        (keydown)="validateInput($event, 'seconds')" (focus)="handleFocus($event)" [class.editable]="contentEditable">{{
        seconds | number: '2.0' }}</span>
    </div>

    <div class="mode-toggles">
      <button class="mode-btn" [class.active]="currentPreset === timerPresets.pomodoro25"
        (click)="setTimer(timerPresets.pomodoro25)" title="Pomodoro {{timerPresets.pomodoro25}}m">
        <div class="custom-icon">
          <span class="material-symbols-rounded">radio_button_unchecked</span>
          <span class="icon-number">{{timerPresets.pomodoro25}}</span>
        </div>
      </button>
      <button class="mode-btn" [class.active]="currentPreset === timerPresets.pomodoro40"
        (click)="setTimer(timerPresets.pomodoro40)" title="Pomodoro {{timerPresets.pomodoro40}}m">
        <div class="custom-icon">
          <span class="material-symbols-rounded">radio_button_unchecked</span>
          <span class="icon-number">{{timerPresets.pomodoro40}}</span>
        </div>
      </button>
      <button class="mode-btn" [class.active]="currentPreset === timerPresets.pomodoro55"
        (click)="setTimer(timerPresets.pomodoro55)" title="Pomodoro {{timerPresets.pomodoro55}}m">
        <div class="custom-icon">
          <span class="material-symbols-rounded">radio_button_unchecked</span>
          <span class="icon-number">{{timerPresets.pomodoro55}}</span>
        </div>
      </button>

      <div class="separator"></div>

      <button class="mode-btn" [class.active]="currentPreset === timerPresets.shortBreak"
        (click)="setTimer(timerPresets.shortBreak)" title="Short Break {{timerPresets.shortBreak}}m">
        <span class="material-symbols-rounded">coffee</span>
      </button>
      <button class="mode-btn" [class.active]="currentPreset === timerPresets.longBreak"
        (click)="setTimer(timerPresets.longBreak)" title="Long Break {{timerPresets.longBreak}}m">
        <span class="material-symbols-rounded">chair</span>
      </button>
    </div>
  </div>

  <!-- Main Controls -->
  <div class="main-controls">
    <button class="secondary-btn" (click)="resetTimer()" title="Reset">
      <span class="material-symbols-rounded">refresh</span>
    </button>

    <button class="play-btn" (click)="isAlive ? pauseTimer() : startTimer()">
      <span class="material-symbols-rounded">{{ isAlive ? 'pause' : 'play_arrow' }}</span>
    </button>

    <button class="secondary-btn" (click)="toggleContentEditable()" title="Edit Time">
      <span class="material-symbols-rounded">edit</span>
    </button>
  </div>

  <!-- Footer -->
  <div class="card-footer">
    <div class="category-section">
      <span class="label">CATEGORY</span>
      <div class="category-selector">
        <select (change)="onCategoryChange($event)">
          <option *ngFor="let category of categories" [value]="category" [selected]="category === selectedCategory">
            {{ category }}
          </option>
        </select>
        <span class="material-symbols-rounded arrow-icon">expand_more</span>
      </div>
    </div>

    <div class="stats-container">
      <div class="stat">
        <span class="value">4</span>
        <span class="label">ROUNDS</span>
      </div>
      <div class="stat">
        <span class="value">2h</span>
        <span class="label">FOCUS</span>
      </div>
    </div>
  </div>
</div>

<!-- Audio Elements -->
<audio #countdownAudio class="display-none">
  <source type="audio/wav" src="/assets/sound/countdown.mp3" />
</audio>
<audio #pomodoroCompleteAudio class="display-none">
  <source type="audio/wav" src="/assets/sound/complete.mp3" />
</audio>